{% extends "base.html" %}
{% block title %}投稿一覧{% endblock %}
{% block content %}
{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
<ul class="mb-6 space-y-1 rounded-lg border border-slate-200 bg-white px-4 py-3 text-sm text-slate-700 shadow-sm">
    {% for category, msg in messages %}
    <li>{{ msg }}</li>
    {% endfor %}
</ul>
{% endif %}
{% endwith %}


<ul class="space-y-4">
    {% for post in posts %}
    <li class="rounded-xl border border-slate-200 bg-white p-5 shadow-sm hover:shadow-md transition-shadow">
        <h2 class="text-lg font-medium text-slate-900 mb-1">
            <a href="{{ url_for('post', post_id=post.id) }}" class="hover:text-slate-600 transition-colors">{{ post.title }}</a>
        </h2>
        <p class="text-slate-600 text-sm leading-relaxed mb-3">{{ post.body }}</p>
        <p class="text-xs text-slate-400">{{ post.created_at }}</p>
    </li>
    {% else %}
    <li class="rounded-xl border border-dashed border-slate-300 bg-white/50 p-10 text-center text-slate-500">
        まだ投稿がありません。
    </li>
    {% endfor %}
</ul>

{% if total > 0 %}
<p class="mt-6 text-center text-sm text-slate-500">全{{ total }}件{% if total_pages > 1 %}（{{ page }}/{{ total_pages }}ページ目）{% endif %}</p>
{% endif %}

{% if total_pages > 1 %}
<nav class="mt-6 flex items-center justify-center gap-2" aria-label="ページナビゲーション">
    {% if has_prev %}
    <a href="{{ url_for('index', page=page - 1) }}"
       class="rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 transition-colors">
        前へ
    </a>
    {% else %}
    <span class="rounded-lg border border-slate-200 bg-slate-50 px-4 py-2 text-sm text-slate-400 cursor-not-allowed">前へ</span>
    {% endif %}

    <span class="flex items-center gap-1">
        {% for p in range(1, total_pages + 1) %}
        {% if p == page %}
        <span class="flex h-9 w-9 items-center justify-center rounded-lg bg-slate-900 text-sm font-medium text-white">{{ p }}</span>
        {% else %}
        <a href="{{ url_for('index', page=p) }}"
           class="flex h-9 w-9 items-center justify-center rounded-lg border border-slate-300 bg-white text-sm font-medium text-slate-700 hover:bg-slate-50 transition-colors">{{ p }}</a>
        {% endif %}
        {% endfor %}
    </span>

    {% if has_next %}
    <a href="{{ url_for('index', page=page + 1) }}"
       class="rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 transition-colors">
        次へ
    </a>
    {% else %}
    <span class="rounded-lg border border-slate-200 bg-slate-50 px-4 py-2 text-sm text-slate-400 cursor-not-allowed">次へ</span>
    {% endif %}
</nav>
{% endif %}
{% endblock %}
